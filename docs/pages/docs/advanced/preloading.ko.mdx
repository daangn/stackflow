import { Callout } from "nextra-theme-docs";

# ë¯¸ë¦¬ API í˜¸ì¶œí•˜ê¸°

<Callout type="info" emoji="ğŸ’¡">
  [Future API](/api-references/future-api/introduction)ë¥¼ ì‚¬ìš©í•˜ë©´ ë¹ŒíŠ¸ì¸ Loader APIë¥¼ í™œìš©í•´ í”„ë¦¬ë¡œë”©ì„ ë” ê¹”ë”í•˜ê²Œ êµ¬í˜„í•  ìˆ˜ ìˆì–´ìš”. [Future API](/api-references/future-api/introduction) ì‚¬ìš©ì„ ê¶Œì¥í•´ìš”.
</Callout>

## Preload í”ŒëŸ¬ê·¸ì¸

Preload í”ŒëŸ¬ê·¸ì¸ì„ í†µí•´ ë¯¸ë¦¬ ì•¡í‹°ë¹„í‹°ì— í•„ìš”í•œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ìˆì–´ìš”.

ë‹¤ìŒ ëª…ë ¹ì–´ë¥¼ í†µí•´ `@stackflow/plugin-preload`ë¥¼ ì„¤ì¹˜í•´ìš”.

```bash npm2yarn copy
npm install @stackflow/plugin-preload
```

ì„¤ì¹˜ê°€ ì™„ë£Œë˜ë©´ ë‹¤ìŒê³¼ ê°™ì´ `stackflow()` í•¨ìˆ˜ì˜ `plugins` í•„ë“œì— í”ŒëŸ¬ê·¸ì¸ì„ ë“±ë¡í•´ìš”.

```typescript showLineNumbers filename="stackflow.ts" copy
import { stackflow } from "@stackflow/react";
import { basicRendererPlugin } from "@stackflow/plugin-renderer-basic";
import { preloadPlugin } from "@stackflow/plugin-preload";
import MyActivity from "./MyActivity";
import Article from "./Article";

const { Stack, useFlow, activities } = stackflow({
  transitionDuration: 350,
  activities: {
    MyActivity,
    Article,
  },
  plugins: [
    basicRendererPlugin(),
    basicUIPlugin({
      theme: "cupertino",
    }),
    preloadPlugin({
      loaders: {
        MyActivity({ activityName, activityParams }) {
          // ì•¡í‹°ë¹„í‹° ì´ë¦„ê³¼ íŒŒë¼ë¯¸í„°ë¥¼ í†µí•´ í•´ë‹¹ ì•¡í‹°ë¹„í‹°ì— í•„ìš”í•œ ë°ì´í„°ë¥¼ ê°€ì ¸ì™€ìš”.
          // í•´ë‹¹ ë°ì´í„°ì— ì ‘ê·¼ í•  ìˆ˜ ìˆëŠ” reference ê°’ì„ ë°˜í™˜í•˜ë©´,
          // í•´ë‹¹ reference ê°’ì„ `useActivityPreloadRef` í›…ì„ í†µí•´ ê°€ì ¸ì˜¬ ìˆ˜ ìˆì–´ìš”.
          return preloadRef;
        },
      },
    }),
  ],
});

export type TypeActivities = typeof activities;
```

ì´í›„ ê° ì•¡í‹°ë¹„í‹° ë‚´ì—ì„œ `useActivityPreloadRef()` í›…ì„ í†µí•´ í•´ë‹¹ `preloadRef` ê°’ì„ ê°€ì ¸ì˜¬ ìˆ˜ ìˆì–´ìš”.

```tsx showLineNumbers filename="MyActivity.ts" copy
import { ActivityComponentType } from "@stackflow/react";
import { useActivityPreloadRef } from "@stackflow/plugin-preload";

const MyActivity: ActivityComponentType = () => {
  const preloadRef = useActivityPreloadRef();

  // Suspense for Data Fetchingì„ í†µí•´ì„œ ì§ì ‘ êµ¬í˜„í•´ìš”.
  // https://ko.reactjs.org/docs/concurrent-mode-suspense.html
  const data = readData({ preloadRef });

  return <div>{/* ... */}</div>;
};
```

ë§Œì•½ íŠ¹ì • ì‹œì ì— ë‹¤ìŒ í™”ë©´ì˜ APIë¥¼ ë¯¸ë¦¬ ê°€ì ¸ì˜¤ê³  ì‹¶ë‹¤ë©´, `@stackflow/plugin-preload`ì—ì„œ ì œê³µí•˜ëŠ” `usePreloader()` í›…ì„ í†µí•´ `preload` í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆì–´ìš”.

`createPreloader()` í•¨ìˆ˜ë¥¼ í†µí•´ Type-safeí•œ `usePreloader()` í›…ì„ ë§Œë“¤ì–´ìš”.

```typescript showLineNumbers filename="usePreloader.ts" copy
import { createPreloader } from "@stackflow/plugin-preload";
import type { TypeActivities } from "./stackflow";

// ë“±ë¡ëœ ì•¡í‹°ë¹„í‹°ì˜ ì „ì²´ íƒ€ì…ì„ ì œë„¤ë¦­ìœ¼ë¡œ ì „ë‹¬í•´, Type-safeí•˜ê²Œ usePreloader() í›…ì„ ì‚¬ìš©í•´ìš”
export const { usePreloader } = createPreloader<TypeActivities>();
```

```tsx showLineNumbers filename="MyActivity.ts" copy
import { ActivityComponentType } from "@stackflow/react";
import { usePreloader } from "./usePreloader";

const MyActivity:  = () => {
  const { preload } = usePreloader();

  useEffect(() => {
    // `MyActivity` ì»´í¬ë„ŒíŠ¸ë¥¼ ë Œë”ë§í•  ë•Œ `Article` ì»´í¬ë„ŒíŠ¸ê°€ í•„ìš”ë¡œí•˜ëŠ” ë°ì´í„°ë¥¼ ê°€ì ¸ì™€ìš”.
    preload("Article", {
      /* ... */
    });
  }, []);

  return <div>{/* ... */}</div>;
};
```

### `<Link />` ì»´í¬ë„ŒíŠ¸

ë§Œì•½ í”„ë¡œì íŠ¸ì—ì„œ Preload í”ŒëŸ¬ê·¸ì¸ê³¼ History Sync í”ŒëŸ¬ê·¸ì¸ì„ ëª¨ë‘ ì‚¬ìš©í•˜ê³  ìˆë‹¤ë©´, `<Link />` ì»´í¬ë„ŒíŠ¸ë¥¼ í™œìš©í•  ìˆ˜ ìˆì–´ìš”.

ë‹¤ìŒ ëª…ë ¹ì–´ë¥¼ í†µí•´ `@stackflow/link`ë¥¼ ì„¤ì¹˜í•´ìš”.

```bash npm2yarn copy
npm install @stackflow/link
```

`createLinkComponent()` í•¨ìˆ˜ë¥¼ í†µí•´ Type-safeí•œ Link ì»´í¬ë„ŒíŠ¸ë¥¼ ë§Œë“¤ì–´ìš”.

```typescript showLineNumbers filename="Link.ts" copy
import { createLinkComponent } from "@stackflow/link";
import type { TypeActivities } from "./stackflow";

// ë§ˆì°¬ê°€ì§€ë¡œ ì•¡í‹°ë¹„í‹°ì˜ ì „ì²´ íƒ€ì…ì„ ì œë„¤ë¦­ìœ¼ë¡œ ì „ë‹¬í•´, Type-safeí•˜ê²Œ <Link /> ì»´í¬ë„ŒíŠ¸ë¥¼ ì‚¬ìš©í•´ìš”
export const { Link } = createLinkComponent<TypeActivities>();
```

ì´í›„ ë‹¤ìŒê³¼ ê°™ì´ `activityName`ê³¼ `activityParams`ë¥¼ Propsë¡œ ê°–ëŠ” `<Link />` ì»´í¬ë„ŒíŠ¸ë¥¼ ì‚¬ìš©í•´ìš”.

```tsx showLineNumbers filename="MyComponent.tsx" copy
import { Link } from './Link'

const MyComponent = () => {
  return (
    <div>
      <Link
        className={...}
        activityName="MyActivity"
        activityParams={{}}
      >
        {/* ... */}
      </Link>
    </div>
  )
}
```

<Callout emoji="âš¡ï¸">
  `<Link />` ì»´í¬ë„ŒíŠ¸ëŠ” ë‚´ë¶€ì ìœ¼ë¡œ `usePreloader()` í›…ì„ ì‚¬ìš©í•´, ì‚¬ìš©ìì˜ ë·°í¬íŠ¸
  ì•ˆì— í•´ë‹¹ ì»´í¬ë„ŒíŠ¸ê°€ ë…¸ì¶œë˜ì—ˆì„ë•Œ ë¯¸ë¦¬ ë°ì´í„°ë¥¼ ê°€ì ¸ì™€ìš”. ë”°ë¼ì„œ, ì‚¬ìš©ìì—ê²Œ
  ë¡œë”©ì´ ì—†ëŠ” íƒí—˜ ê²½í—˜ì„ ì œê³µí•  ìˆ˜ ìˆì–´ìš”.
</Callout>
