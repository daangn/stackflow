import { Callout } from "nextra-theme-docs";
import DiagramStep from "../../components/DiagramStep.tsx";

# νƒμƒ‰ν•κΈ°

μ„±κ³µμ μΌλ΅ μ•΅ν‹°λΉ„ν‹°λ¥Ό λ“±λ΅ν–λ‹¤λ©΄, μ΄μ  μ•΅ν‹°λΉ„ν‹° μ‚¬μ΄λ¥Ό μ΄λ™ν•΄λ³Ό μ°¨λ΅€μ—μ”. **Stackflow**μ—μ„λ” `useFlow()`λ¥Ό ν†µν•΄ μ•΅ν‹°λΉ„ν‹°λ¥Ό μ“κ±°λ‚, κµμ²΄ν•κ±°λ‚, μ‚­μ ν•  μ μλ„λ΅ μ§€μ›ν•κ³  μμ–΄μ”. ν•λ² μ•μ•„λ³ΌκΉμ”?

## μƒ μ•΅ν‹°λΉ„ν‹° μ“κΈ°

`stackflow.ts`μ—μ„ μƒμ„±ν–λ `useFlow()` ν›…μ„ μ‚¬μ©ν•΄μ”. ν•΄λ‹Ή ν›… λ‚΄μ— `push()` ν•¨μλ¥Ό ν†µν•΄ λ‹¤μκ³Ό κ°™μ΄ μƒ μ•΅ν‹°λΉ„ν‹°λ¥Ό μ“μ„ μ μμ–΄μ”.

```tsx
/**
 * MyActivity.tsx
 */
import { ActivityComponentType } from "@stackflow/react";
import { AppScreen } from "@stackflow/plugin-basic-ui";
import { useFlow } from "./stackflow";

const MyActivity: ActivityComponentType = () => {
  const { push } = useFlow();

  const onClick = () => {
    push("Article", {
      title: "Hello",
    });
  };

  return (
    <AppScreen appBar={{ title: "My Activity" }}>
      <div>
        My Activity
        <button onClick={onClick}>Go to article page</button>
      </div>
    </AppScreen>
  );
};

export default MyActivity;
```

`push()`λ” μ²«λ²μ§Έ νλΌλ―Έν„°λ΅ μ΄λ™ν•  μ•΅ν‹°λΉ„ν‹°μ μ΄λ¦„, λ‘λ²μ§Έ νλΌλ―Έν„°λ΅ μ΄λ™ν•  μ•΅ν‹°λΉ„ν‹°μ νλΌλ―Έν„°, μ„Έλ²μ§Έ νλΌλ―Έν„°λ΅ μ¶”κ°€ μµμ…μ„ λ°›μ•„μ”. μ„Έλ²μ§Έ νλΌλ―Έν„°μΈ μ¶”κ°€ μµμ…μ€ μ„ νƒμ μΌλ΅ λ„κΈ°μ§€ μ•μ„ μ μμ–΄μ”. (κΈ°λ³Έκ°’μ„ μ‚¬μ©ν•΄μ”)

```typescript
push("μ•΅ν‹°λΉ„ν‹°_μ΄λ¦„", {
  /* μ•΅ν‹°λΉ„ν‹° νλΌλ―Έν„° */
});

// λλ”
push(
  "μ•΅ν‹°λΉ„ν‹°_μ΄λ¦„",
  {
    /* μ•΅ν‹°λΉ„ν‹° νλΌλ―Έν„° */
  },
  {
    /* μ¶”κ°€ μµμ… */
  },
);
```

`push()` ν•¨μμ μ„Έλ²μ§Έ νλΌλ―Έν„°μΈ μ¶”κ°€ μµμ…μ—λ” λ‹¤μκ³Ό κ°™μ€ κ°’μ΄ μμ–΄μ”.

| μµμ…λ…    | μ—­ν•                      | νƒ€μ…    | κΈ°λ³Έκ°’ |
| --------- | ------------------------ | ------- | ------ |
| `animate` | μ• λ‹λ©”μ΄μ…μ„ μΌκ±°λ‚ κΊΌμ” | Boolean | `true` |

<Callout emoji="π’΅">
  TypeScriptλ¥Ό ν™μ©ν•λ©΄, μ•΅ν‹°λΉ„ν‹° μ΄λ¦„κ³Ό μ•΅ν‹°λΉ„ν‹° νλΌλ―Έν„°κ°€ μ—„κ²©ν•κ² νƒ€μ΄ν•‘
  λμ–΄μλ” λ¨μµμ„ ν™•μΈν•μ‹¤ μ μμ–΄μ”. TypeScriptλ¥Ό ν†µν•΄ μ•μ „ν•λ©΄μ„ νΈλ¦¬ν•κ²
  **Stackflow**λ¥Ό ν™μ©ν•΄λ³΄μ„Έμ”.
</Callout>

## ν„μ¬ μ•΅ν‹°λΉ„ν‹° κµμ²΄ν•κΈ°

λ‹¤μμΌλ΅ μ¤νƒμ— μƒλ΅μ΄ μ•΅ν‹°λΉ„ν‹°λ¥Ό μ¶”κ°€ν•μ§€ μ•κ³  ν„μ¬ μ•΅ν‹°λΉ„ν‹°λ¥Ό κµμ²΄ν•λ” λ°©λ²•μ— λ€ν•΄μ„ μ‚΄ν΄λ΄μ”. `stackflow.ts`μ—μ„ μƒμ„±ν–λ `useFlow()` ν›…μ `replace()` ν•¨μλ¥Ό ν†µν•΄ λ‹¤μκ³Ό κ°™μ΄ ν„μ¬ μ•΅ν‹°λΉ„ν‹°λ¥Ό κµμ²΄ν•  μ μμ–΄μ”.

```tsx
/**
 * MyActivity.tsx
 */
import { ActivityComponentType } from "@stackflow/react";
import { AppScreen } from "@stackflow/plugin-basic-ui";
import { useFlow } from "./stackflow";

const MyActivity: ActivityComponentType = () => {
  const { replace } = useFlow();

  const onClick = () => {
    replace("Article", {
      title: "Hello",
    });
  };

  return (
    <AppScreen appBar={{ title: "My Activity" }}>
      <div>
        My Activity
        <button onClick={onClick}>Go to article page</button>
      </div>
    </AppScreen>
  );
};

export default MyActivity;
```

`replace()`λ” `push()`μ™€ λΉ„μ·ν• APIλ¥Ό κ°–κ³  μμ–΄μ”. μ²«λ²μ§Έ νλΌλ―Έν„°λ΅ μ΄λ™ν•  μ•΅ν‹°λΉ„ν‹°μ μ΄λ¦„, λ‘λ²μ§Έ νλΌλ―Έν„°λ΅ μ΄λ™ν•  μ•΅ν‹°λΉ„ν‹°μ νλΌλ―Έν„°, μ„Έλ²μ§Έ νλΌλ―Έν„°λ΅ μ¶”κ°€ μµμ…μ„ λ°›μ•„μ”. μ„Έλ²μ§Έ νλΌλ―Έν„°μΈ μ¶”κ°€ μµμ…μ€ μ„ νƒμ μΌλ΅ λ„κΈ°μ§€ μ•μ„ μ μμ–΄μ”. (κΈ°λ³Έκ°’μ„ μ‚¬μ©ν•΄μ”)

```typescript
replace("μ•΅ν‹°λΉ„ν‹°_μ΄λ¦„", {
  /* μ•΅ν‹°λΉ„ν‹° νλΌλ―Έν„° */
});

// λλ”
replace(
  "μ•΅ν‹°λΉ„ν‹°_μ΄λ¦„",
  {
    /* μ•΅ν‹°λΉ„ν‹° νλΌλ―Έν„° */
  },
  {
    /* μ¶”κ°€ μµμ… */
  },
);
```

`replace()` ν•¨μμ μ„Έλ²μ§Έ νλΌλ―Έν„°μΈ μ¶”κ°€ μµμ…μ—λ” λ‹¤μκ³Ό κ°™μ€ κ°’μ΄ μμ–΄μ”.

| μµμ…λ…    | μ—­ν•                      | νƒ€μ…    | κΈ°λ³Έκ°’ |
| --------- | ------------------------ | ------- | ------ |
| `animate` | μ• λ‹λ©”μ΄μ…μ„ μΌκ±°λ‚ κΊΌμ” | Boolean | `true` |

## ν„μ¬ μ•΅ν‹°λΉ„ν‹° μ‚­μ ν•κΈ°

λ§μ§€λ§‰μΌλ΅ ν„μ¬ μ•΅ν‹°λΉ„ν‹°λ¥Ό μ‚­μ ν•κ³  μ΄μ „ μ•΅ν‹°λΉ„ν‹°λ΅ λμ•„κ°€λ” λ°©λ²•μ— λ€ν•΄μ„ μ‚΄ν΄λ΄μ”. `stackflow.ts`μ—μ„ μƒμ„±ν–λ `useFlow()` ν›…μ `pop()` ν•¨μλ¥Ό ν†µν•΄ λ‹¤μκ³Ό κ°™μ΄ ν„μ¬ μ•΅ν‹°λΉ„ν‹°λ¥Ό μ‚­μ ν•  μ μμ–΄μ”.

```tsx
/**
 * Article.tsx
 */
import { ActivityComponentType } from "@stackflow/react";
import { AppScreen } from "@stackflow/plugin-basic-ui";
import { useFlow } from "./stackflow";

type ArticleParams = {
  title: string;
};
const Article: ActivityComponentType<ArticleParams> = ({ params }) => {
  const { pop } = useFlow();

  const onClick = () => {
    pop();
  };

  return (
    <AppScreen appBar={{ title: "Article" }}>
      <div>
        <h1>{params.title}</h1>
        <button onClick={onClick}>back</button>
      </div>
    </AppScreen>
  );
};

export default Article;
```

`pop()`μ€ μ²«λ²μ§Έ νλΌλ―Έν„°λ΅ μ¶”κ°€ μµμ…μ„ λ°›μ•„μ”. μ²«λ²μ§Έ νλΌλ―Έν„°μΈ μ¶”κ°€ μµμ…μ€ μ„ νƒμ μΌλ΅ λ„κΈ°μ§€ μ•μ„ μ μμ–΄μ”. (κΈ°λ³Έκ°’μ„ μ‚¬μ©ν•΄μ”)

```typescript
pop();

// λλ”
pop({
  /* μ¶”κ°€ μµμ… */
});
```

`pop()` ν•¨μμ μ²«λ²μ§Έ νλΌλ―Έν„°μΈ μ¶”κ°€ μµμ…μ—λ” λ‹¤μκ³Ό κ°™μ€ κ°’μ΄ μμ–΄μ”.

| μµμ…λ…    | μ—­ν•                      | νƒ€μ…    | κΈ°λ³Έκ°’ |
| --------- | ------------------------ | ------- | ------ |
| `animate` | μ• λ‹λ©”μ΄μ…μ„ μΌκ±°λ‚ κΊΌμ” | Boolean | `true` |

---

## μ¤ν…

<DiagramStep />

1κ°μ μ•΅ν‹°λΉ„ν‹° λ‚΄λ¶€μ—μ„ κ°€μƒμ μ¤νƒ μƒνƒλ¥Ό κ°€μ§€κ³  μ‹¶μ„λ• μ¤ν…μ„ μ‚¬μ©ν•  μ μμ–΄μ”. μ¤ν…μ€ κΈ°λ³Έμ μΌλ΅ μ•΅ν‹°λΉ„ν‹°μ νλΌλ―Έν„°λ¥Ό λ°”κΎΈλ” μ‹μΌλ΅ λ™μ‘ν•΄μ”.

<Callout emoji="π’΅">
  `@stackflow/plugin-history-sync`λ” μ¤ν…μ„ μ§€μ›ν•΄μ”. λ§μ•½ λ¨λ°”μΌμ—μ„ νΉμ • μƒνƒ
  μ΅°μ‘κ³Ό ν•¨κ» μ•λ“λ΅μ΄λ“ λ°±λ²„νΌ μ§€μ›μ΄ ν•„μ”ν• κ²½μ° `history.pushState()`λ³΄λ‹¤
  μ¤ν… κΈ°λ¥μ„ ν™μ©ν•μ‹λ©΄ λ” μΆ‹μ•„μ”.
</Callout>

## μƒ μ¤ν… μ“κΈ°

`stackflow.ts`μ—μ„ μƒμ„±ν•  μ μλ” `useStepFlow()` ν›…μ„ μ‚¬μ©ν•΄μ”. ν•΄λ‹Ή ν›… λ‚΄μ— `stepPush()` ν•¨μλ¥Ό ν†µν•΄ λ‹¤μκ³Ό κ°™μ΄ μƒ μ¤ν…μ„ μ“μ„ μ μμ–΄μ”.

```tsx
/**
 * Article.tsx
 */
import { ActivityComponentType } from "@stackflow/react";
import { AppScreen } from "@stackflow/plugin-basic-ui";
import { useStepFlow } from "./stackflow";

type ArticleParams = {
  title: string;
};
const Article: ActivityComponentType<ArticleParams> = ({ params }) => {
  // νƒ€μ… μ•μ •μ„±μ„ μ„ν•΄ ν„μ¬ μ•΅ν‹°λΉ„ν‹°μ μ΄λ¦„μ„ λ„£μ–΄μ¤μ”
  const { stepPush } = useStepFlow("Article");

  const onNextClick = () => {
    // `stepPush()`μ„ νΈμ¶ν•λ©΄ params.titleμ΄ λ³€κ²½λΌμ”.
    stepPush({
      title: "Next Title",
    });
  };

  return (
    <AppScreen appBar={{ title: "Article" }}>
      <div>
        <h1>{params.title}</h1>
        <button onClick={onNextClick}>next</button>
      </div>
    </AppScreen>
  );
};

export default Article;
```

## μ¤ν… κµμ²΄ν•κΈ°

`useStepFlow()`μ `stepReplace()` ν•¨μλ¥Ό ν™μ©ν•λ©΄ ν„μ¬ μ¤ν…μ„ κµμ²΄ν•  μ μμ–΄μ”.

```tsx
/**
 * Article.tsx
 */
import { ActivityComponentType } from "@stackflow/react";
import { AppScreen } from "@stackflow/plugin-basic-ui";
import { useStepFlow } from "./stackflow";

type ArticleParams = {
  title: string;
};
const Article: ActivityComponentType<ArticleParams> = ({ params }) => {
  // νƒ€μ… μ•μ •μ„±μ„ μ„ν•΄ ν„μ¬ μ•΅ν‹°λΉ„ν‹°μ μ΄λ¦„μ„ λ„£μ–΄μ¤μ”
  const { stepReplace } = useStepFlow("Article");

  const onChangeClick = () => {
    // `stepReplace()`μ„ νΈμ¶ν•λ©΄ params.titleμ΄ λ³€κ²½λΌμ”
    stepReplace({
      title: "Next Title",
    });
  };

  return (
    <AppScreen appBar={{ title: "Article" }}>
      <div>
        <h1>{params.title}</h1>
        <button onClick={onChangeClick}>change</button>
      </div>
    </AppScreen>
  );
};

export default Article;
```

## μ¤ν… μ‚­μ ν•κΈ°

`useStepFlow()`μ `stepPop()` ν•¨μλ¥Ό ν™μ©ν•λ©΄ ν„μ¬ μ¤ν…μ„ μ‚­μ ν•  μ μμ–΄μ”.

```tsx
/**
 * Article.tsx
 */
import { ActivityComponentType } from "@stackflow/react";
import { AppScreen } from "@stackflow/plugin-basic-ui";
import { useStepFlow } from "./stackflow";

type ArticleParams = {
  title: string;
};
const Article: ActivityComponentType<ArticleParams> = ({ params }) => {
  // νƒ€μ… μ•μ •μ„±μ„ μ„ν•΄ ν„μ¬ μ•΅ν‹°λΉ„ν‹°μ μ΄λ¦„μ„ λ„£μ–΄μ¤μ”
  const { stepPop } = useStepFlow("Article");

  const onPrevClick = () => {
    // `stepPop()`μ„ νΈμ¶ν•λ©΄ μ΄μ „ params.titleλ΅ λμ•„κ°€μ”
    stepPop();
  };

  return (
    <AppScreen appBar={{ title: "Article" }}>
      <div>
        <h1>{params.title}</h1>
        <button onClick={onPrevClick}>prev</button>
      </div>
    </AppScreen>
  );
};

export default Article;
```

<Callout emoji="π’΅">
  λ§μ•½ μ‚­μ ν•  μ¤ν…μ΄ μ—†λ” μƒνƒλΌλ©΄, μ•„λ¬΄κ²ƒλ„ μΌμ–΄λ‚μ§€ μ•μ•„μ”.
</Callout>

<Callout emoji="π’΅">
  μ—¬λ¬κ°μ μ¤ν…μ΄ ν‘Έμ‹λ μƒνƒμ—μ„ `useFlow().pop()`μ„ ν™μ©ν•λ©΄ μ•΅ν‹°λΉ„ν‹° λ‚΄λ¶€μ—
  μ“μ—¬μ Έμλ” λ¨λ“  μ¤ν…λ“¤μ΄ ν•λ²μ— μ—†μ–΄μ Έμ”.
</Callout>

---

μ—¬κΈ°κΉμ§€ κΈ°λ³Έμ μΈ **Stackflow**μ ν™μ©λ²•μ„ μ•μ•„λ΄¤λ”λ°μ”. μ΄μ  ν™μ©ν•λ” κ²ƒμ„ λ„μ–΄μ„μ„ μ¤νƒ μƒνƒμ λ‚΄λ¶€ κµ¬μ΅°μ™€ μ΄λ¥Ό μ΄μ©ν• κµ¬μ²΄μ μΈ μ‘μ© λ°©λ²•μ— λ€ν•΄ μ•μ•„λ³Όκ»μ”.
